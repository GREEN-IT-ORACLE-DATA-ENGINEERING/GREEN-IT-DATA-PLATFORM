alter session set container = green_it_pdb;

-- VÃ©rifier qui tu es
select user
  from dual;
--Staging Table Creation (Raw Data Layer)
-- Create the Staging Table in its dedicated tablespace
-- Best Practice: No constraints allowed here to facilitate bulk loading
create table green_it_owner.stg_green_workload (
   record_id          varchar2(50),
   workload_type      varchar2(100),
   compute_demand     number,
   storage_demand     number,
   network_demand     number,
   energy_source      varchar2(100),
   energy_consumption number,
   renewable_share    number,
   carbon_emissions   number,
   qso_optimization   number,
   uncertainty_factor number,
   security_level     varchar2(50),
   pqc_enabled        number, -- Boolean as 0 or 1
   energy_efficiency  number,
   service_quality    number,
   secure_ops_score   number,
   workload_scenario  varchar2(100),
   scenario_strategy  varchar2(100),
   operational_cost   number,
   performance_metric number
)
tablespace ts_green_staging;


-- The Star Schema Implementation
--1.Dimension Tables
-- DIM_WORKLOAD: In TS_DIM_WORKLOAD
create table green_it_owner.dim_workload (
   workload_key  number generated by default as identity primary key,
   record_id     varchar2(50), -- Original ID from CSV
   workload_type varchar2(100)
)
tablespace ts_dim_workload;

--  DIM_ENERGY: In TS_DIM_ENERGY
create table green_it_owner.dim_energy (
   energy_key     number generated by default as identity primary key,
   energy_source  varchar2(100),
   renewable_flag number(1) -- 1 for True, 0 for False
)
tablespace ts_dim_energy;

-- DIM_SECURITY: In TS_DIM_SECURITY
create table green_it_owner.dim_security (
   security_key   number generated by default as identity primary key,
   security_level varchar2(50),
   pqc_enabled    number(1)
)
tablespace ts_dim_security;

-- DIM_SCENARIO: In TS_DIM_SCENARIO
create table green_it_owner.dim_scenario (
   scenario_key      number generated by default as identity primary key,
   workload_scenario varchar2(100),
   scenario_strategy varchar2(100)
)
tablespace ts_dim_scenario;

--2. The Fact Table (Center of the Star)
-- FACT_GREEN_WORKLOAD: In TS_FACT_GREEN
create table green_it_owner.fact_green_workload (
   fact_key               number generated by default as identity primary key,
    -- Foreign Keys
   workload_key           number
      references green_it_owner.dim_workload ( workload_key ),
   energy_key             number
      references green_it_owner.dim_energy ( energy_key ),
   security_key           number
      references green_it_owner.dim_security ( security_key ),
   scenario_key           number
      references green_it_owner.dim_scenario ( scenario_key ),
    -- Metrics (Quantitative Data)
   compute_demand_tflops  number,
   storage_demand_tb      number,
   network_demand_gbps    number,
   energy_consumption_kwh number,
   carbon_emissions_kgco2 number,
   operational_cost_usd   number,
   performance_metric     number,
    -- Audit Column (Professional Practice)
   load_date              date default sysdate
)
tablespace ts_fact_green;

commit;